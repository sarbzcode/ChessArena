(function(){"use strict";var Be=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Bt(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}function Yt(d){if(Object.prototype.hasOwnProperty.call(d,"__esModule"))return d;var k=d.default;if(typeof k=="function"){var E=function v(){var S=!1;try{S=this instanceof v}catch{}return S?Reflect.construct(k,arguments,this.constructor):k.apply(this,arguments)};E.prototype=k.prototype}else E={};return Object.defineProperty(E,"__esModule",{value:!0}),Object.keys(d).forEach(function(v){var S=Object.getOwnPropertyDescriptor(d,v);Object.defineProperty(E,v,S.get?S:{enumerable:!0,get:function(){return d[v]}})}),E}var be={exports:{}},qt={},Ut=Object.freeze({__proto__:null,default:qt}),F=Yt(Ut);var Ye;function Ht(){return Ye||(Ye=1,(function(d,k){var E=(function(){var v=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(v=v||__filename),(function(S){S=S||{};function L(){return y.buffer!=M&&W(y.buffer),ze}function C(){return y.buffer!=M&&W(y.buffer),Xe}function s(){return y.buffer!=M&&W(y.buffer),Qe}function g(){return y.buffer!=M&&W(y.buffer),$e}function ke(){return y.buffer!=M&&W(y.buffer),Je}var n;n||(n=typeof S<"u"?S:{});var xe,Me;n.ready=new Promise(function(e,t){xe=e,Me=t}),(function(){function e(){var i=a.shift();if(!t&&i!==void 0){if(i==="quit")return n.terminate();var l=n.ccall("uci_command","number",["string"],[i]);l&&a.unshift(i),u=l?2*u:1,setTimeout(e,u)}}var t=!1,r=[];n.print=function(i){r.length===0?console.log(i):setTimeout(function(){for(var l=0;l<r.length;l++)r[l](i)})},n.addMessageListener=function(i){r.push(i)},n.removeMessageListener=function(i){i=r.indexOf(i),0<=i&&r.splice(i,1)},n.terminate=function(){t=!0,f.Ea()};var a=[],u=1;n.postMessage=function(i){a.push(i)},n.postRun=function(){n.postMessage=function(i){a.push(i),a.length===1&&e()},e()}})();var Q={},D;for(D in n)n.hasOwnProperty(D)&&(Q[D]=n[D]);var Se=[],ae="./this.program";function oe(e,t){throw t}var ie=!1,I=!1,O=!1;ie=typeof window=="object",I=typeof importScripts=="function",O=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";var c=n.ENVIRONMENT_IS_PTHREAD||!1;c&&(M=n.buffer);var x="";function qe(e){return n.locateFile?n.locateFile(e,x):x+e}var $,J,N,G;if(O){x=I?F.dirname(x)+"/":__dirname+"/",$=function(e,t){return N||(N=F),G||(G=F),e=G.normalize(e),N.readFileSync(e,t?null:"utf8")},J=function(e){return e=$(e,!0),e.buffer||(e=new Uint8Array(e)),K(e.buffer),e},1<process.argv.length&&(ae=process.argv[1].replace(/\\/g,"/")),Se=process.argv.slice(2),process.on("uncaughtException",function(e){if(!(e instanceof X))throw e}),process.on("unhandledRejection",Y),oe=function(e){process.exit(e)},n.inspect=function(){return"[Emscripten Module object]"};var Ue;try{Ue=F}catch(e){throw console.error('The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?'),e}Be.Worker=Ue.Worker}else(ie||I)&&(I?x=self.location.href:typeof document<"u"&&document.currentScript&&(x=document.currentScript.src),v&&(x=v),x.indexOf("blob:")!==0?x=x.substr(0,x.lastIndexOf("/")+1):x="",O?($=function(e,t){return N||(N=F),G||(G=F),e=G.normalize(e),N.readFileSync(e,t?null:"utf8")},J=function(e){return e=$(e,!0),e.buffer||(e=new Uint8Array(e)),K(e.buffer),e}):($=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},I&&(J=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)})));O&&typeof performance>"u"&&(Be.performance=F.performance);var He=n.print||console.log.bind(console),b=n.printErr||console.warn.bind(console);for(D in Q)Q.hasOwnProperty(D)&&(n[D]=Q[D]);Q=null,n.arguments&&(Se=n.arguments),n.thisProgram&&(ae=n.thisProgram),n.quit&&(oe=n.quit);var ue,Z;n.wasmBinary&&(Z=n.wasmBinary);var V;n.noExitRuntime&&(V=n.noExitRuntime),typeof WebAssembly!="object"&&Y("no native wasm support detected");var y,Le,Te=!1;function K(e,t){e||Y("Assertion failed: "+t)}function Kt(e){var t=n["_"+e];return K(t,"Cannot call unknown function "+e+", make sure it is exported"),t}function Ne(e,t,r){r=t+r;for(var a="";!(t>=r);){var u=e[t++];if(!u)break;if(u&128){var i=e[t++]&63;if((u&224)==192)a+=String.fromCharCode((u&31)<<6|i);else{var l=e[t++]&63;u=(u&240)==224?(u&15)<<12|i<<6|l:(u&7)<<18|i<<12|l<<6|e[t++]&63,65536>u?a+=String.fromCharCode(u):(u-=65536,a+=String.fromCharCode(55296|u>>10,56320|u&1023))}}else a+=String.fromCharCode(u)}return a}function j(e){return e?Ne(C(),e,void 0):""}function se(e,t,r,a){if(0<a){a=r+a-1;for(var u=0;u<e.length;++u){var i=e.charCodeAt(u);if(55296<=i&&57343>=i){var l=e.charCodeAt(++u);i=65536+((i&1023)<<10)|l&1023}if(127>=i){if(r>=a)break;t[r++]=i}else{if(2047>=i){if(r+1>=a)break;t[r++]=192|i>>6}else{if(65535>=i){if(r+2>=a)break;t[r++]=224|i>>12}else{if(r+3>=a)break;t[r++]=240|i>>18,t[r++]=128|i>>12&63}t[r++]=128|i>>6&63}t[r++]=128|i&63}}t[r]=0}}function De(e){for(var t=0,r=0;r<e.length;++r){var a=e.charCodeAt(r);55296<=a&&57343>=a&&(a=65536+((a&1023)<<10)|e.charCodeAt(++r)&1023),127>=a?++t:t=2047>=a?t+2:65535>=a?t+3:t+4}return t}function Ge(e){var t=De(e)+1,r=U(t);return se(e,L(),r,t),r}function Ve(e,t){L().set(e,t)}var M,ze,Xe,Qe,$e,Je;function W(e){M=e,n.HEAP8=ze=new Int8Array(e),n.HEAP16=new Int16Array(e),n.HEAP32=Qe=new Int32Array(e),n.HEAPU8=Xe=new Uint8Array(e),n.HEAPU16=new Uint16Array(e),n.HEAPU32=$e=new Uint32Array(e),n.HEAPF32=new Float32Array(e),n.HEAPF64=Je=new Float64Array(e)}var Ze=n.INITIAL_MEMORY||67108864;if(c)y=n.wasmMemory,M=n.buffer;else if(n.wasmMemory)y=n.wasmMemory;else if(y=new WebAssembly.Memory({initial:Ze/65536,maximum:32768,shared:!0}),!(y.buffer instanceof SharedArrayBuffer))throw b("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),O&&console.log("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and also use a recent version)"),Error("bad memory");y&&(M=y.buffer),Ze=M.byteLength,W(M);var fe,Ke=[],et=[],er=[],tt=[];c||et.push({Ia:function(){Et()}});function tr(){var e=n.preRun.shift();Ke.unshift(e)}var B=0,ee=null;n.preloadedImages={},n.preloadedAudios={};function Y(e){throw n.onAbort&&n.onAbort(e),c&&console.error("Pthread aborting at "+Error().stack),b(e),Te=!0,e=new WebAssembly.RuntimeError("abort("+e+"). Build with -s ASSERTIONS=1 for more info."),Me(e),e}function rt(){var e=R;return String.prototype.startsWith?e.startsWith("data:application/octet-stream;base64,"):e.indexOf("data:application/octet-stream;base64,")===0}var R="stockfish.wasm";rt()||(R=qe(R));function nt(){var e=R;try{if(e==R&&Z)return new Uint8Array(Z);if(J)return J(e);throw"both async and sync fetching of the wasm failed"}catch(t){Y(t)}}function rr(){return Z||!ie&&!I||typeof fetch!="function"?Promise.resolve().then(function(){return nt()}):fetch(R,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+R+"'";return e.arrayBuffer()}).catch(function(){return nt()})}var at={11752:function(){throw"Canceled!"},12164:function(e,t){setTimeout(function(){Dt(e,t)},0)}};function le(e){for(;0<e.length;){var t=e.shift();if(typeof t=="function")t(n);else{var r=t.Ia;typeof r=="number"?t.ma===void 0?fe.get(r)():fe.get(r)(t.ma):r(t.ma===void 0?null:t.ma)}}}function ce(e,t){if(0>=e||e>L().length||e&1||0>t)return-28;if(t==0)return 0;2147483647<=t&&(t=1/0);var r=Atomics.load(s(),z>>2),a=0;if(r==e&&Atomics.compareExchange(s(),z>>2,r,0)==r&&(--t,a=1,0>=t))return 1;if(e=Atomics.notify(s(),e>>2,t),0<=e)return e+a;throw"Atomics.notify returned an unexpected value "+e}n._emscripten_futex_wake=ce;function ot(e){if(c)throw"Internal Error! cleanupThread() can only ever be called from main application thread!";if(!e)throw"Internal Error! Null pthread_ptr in cleanupThread!";s()[e+12>>2]=0,(e=f.ga[e])&&f.ta(e.worker)}var f={fa:[],ia:[],La:function(){for(var e=0;1>e;++e)f.za()},Ma:function(){for(var e=q(228),t=0;57>t;++t)g()[e/4+t]=0;s()[e+12>>2]=e,t=e+152,s()[t>>2]=t;var r=q(512);for(t=0;128>t;++t)g()[r/4+t]=0;Atomics.store(g(),e+100>>2,r),Atomics.store(g(),e+40>>2,e),ve(e,!I,1),St(e)},Na:function(){f.receiveObjectTransfer=f.Pa,f.setThreadStatus=f.Ra,f.threadCancel=f.Ta,f.threadExit=f.Ua},ga:{},Fa:[],Ra:function(){},Da:function(){for(;0<f.Fa.length;)f.Fa.pop()();c&&P()&&Mt()},Ua:function(e){var t=P();t&&(Atomics.store(g(),t+4>>2,e),Atomics.store(g(),t+0>>2,1),Atomics.store(g(),t+56>>2,1),Atomics.store(g(),t+60>>2,0),f.Da(),ce(t+0,2147483647),ve(0,0,0),c&&postMessage({cmd:"exit"}))},Ta:function(){f.Da();var e=P();Atomics.store(g(),e+4>>2,-1),Atomics.store(g(),e+0>>2,1),ce(e+0,2147483647),ve(0,0,0),postMessage({cmd:"cancelDone"})},Ea:function(){for(var e in f.ga){var t=f.ga[e];t&&t.worker&&f.ta(t.worker)}for(f.ga={},e=0;e<f.fa.length;++e){var r=f.fa[e];r.terminate()}for(f.fa=[],e=0;e<f.ia.length;++e)r=f.ia[e],t=r.ea,f.ya(t),r.terminate();f.ia=[]},ya:function(e){if(e){if(e.ha){var t=s()[e.ha+100>>2];s()[e.ha+100>>2]=0,ge(t),ge(e.ha)}e.ha=0,e.xa&&e.ja&&ge(e.ja),e.ja=0,e.worker&&(e.worker.ea=null)}},ta:function(e){f.Qa(function(){delete f.ga[e.ea.ha],f.fa.push(e),f.ia.splice(f.ia.indexOf(e),1),f.ya(e.ea),e.ea=void 0})},Qa:function(e){s()[Ft>>2]=0;try{e()}finally{s()[Ft>>2]=1}},Pa:function(){},Ba:function(e,t){e.onmessage=function(r){var a=r.data,u=a.cmd;if(e.ea&&(f.Ga=e.ea.ha),a.targetThread&&a.targetThread!=P()){var i=f.ga[a.lb];i?i.worker.postMessage(r.data,a.transferList):console.error('Internal error! Worker sent a message "'+u+'" to target pthread '+a.targetThread+", but that thread no longer exists!")}else if(u==="processQueuedMainThreadWork")_e();else if(u==="spawnThread")bt(r.data);else if(u==="cleanupThread")ot(a.thread);else if(u==="killThread"){if(r=a.thread,c)throw"Internal Error! killThread() can only ever be called from main application thread!";if(!r)throw"Internal Error! Null pthread_ptr in killThread!";s()[r+12>>2]=0,r=f.ga[r],r.worker.terminate(),f.ya(r),f.ia.splice(f.ia.indexOf(r.worker),1),r.worker.ea=void 0}else if(u==="cancelThread"){if(r=a.thread,c)throw"Internal Error! cancelThread() can only ever be called from main application thread!";if(!r)throw"Internal Error! Null pthread_ptr in cancelThread!";f.ga[r].worker.postMessage({cmd:"cancel"})}else if(u==="loaded")e.loaded=!0,t&&t(e),e.na&&(e.na(),delete e.na);else if(u==="print")He("Thread "+a.threadId+": "+a.text);else if(u==="printErr")b("Thread "+a.threadId+": "+a.text);else if(u==="alert")alert("Thread "+a.threadId+": "+a.text);else if(u==="exit")e.ea&&Atomics.load(g(),e.ea.ha+64>>2)&&f.ta(e);else if(u==="exitProcess")try{We(a.returnCode)}catch(l){if(l instanceof X)return;throw l}else u==="cancelDone"?f.ta(e):u!=="objectTransfer"&&(r.data.target==="setimmediate"?e.postMessage(r.data):b("worker sent an unknown command "+u));f.Ga=void 0},e.onerror=function(r){b("pthread sent an error! "+r.filename+":"+r.lineno+": "+r.message)},O&&(e.on("message",function(r){e.onmessage({data:r})}),e.on("error",function(r){e.onerror(r)}),e.on("exit",function(){})),e.postMessage({cmd:"load",urlOrBlob:n.mainScriptUrlOrBlob||v,wasmMemory:y,wasmModule:Le})},za:function(){var e=qe("stockfish.worker.js");f.fa.push(new Worker(e))},Ja:function(){return f.fa.length==0&&(f.za(),f.Ba(f.fa[0])),0<f.fa.length?f.fa.pop():null},$a:function(e){for(e=performance.now()+e;performance.now()<e;);}};n.establishStackSpace=function(e,t){Rt(e,t),te(e)},n.getNoExitRuntime=function(){return V},n.invokeEntryPoint=function(e,t){return fe.get(e)(t)};var Ie;Ie=O?function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:c?function(){return performance.now()-n.__performance_now_clock_drift}:function(){return performance.now()};var nr=[null,[],[]],it={};function ut(e,t,r){return c?T(2,1,e,t,r):0}function st(e,t,r){return c?T(3,1,e,t,r):0}function ft(e,t,r){if(c)return T(4,1,e,t,r)}function lt(){O||I||(ue||(ue={}),ue["Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread"]||(ue["Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread"]=1,b("Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread")))}function ct(e,t,r){if(0>=e||e>L().length||e&1)return-28;if(ie){if(Atomics.load(s(),e>>2)!=t)return-6;var a=performance.now();for(r=a+r,Atomics.exchange(s(),z>>2,e);;){if(a=performance.now(),a>r)return Atomics.exchange(s(),z>>2,0),-73;if(a=Atomics.exchange(s(),z>>2,0),a==0)break;if(_e(),Atomics.load(s(),e>>2)!=t)return-6;Atomics.exchange(s(),z>>2,e)}return 0}if(e=Atomics.wait(s(),e>>2,t,r),e==="timed-out")return-73;if(e==="not-equal")return-6;if(e==="ok")return 0;throw"Atomics.wait returned an unexpected value "+e}function T(e,t){for(var r=arguments.length-2,a=ye(),u=U(8*r),i=u>>3,l=0;l<r;l++){var m=arguments[2+l];ke()[i+l]=m}return r=Ot(e,r,u,t),te(a),r}var Oe=[],je=[],ar=[0,typeof document<"u"?document:0,typeof window<"u"?window:0];function Re(e){return e=2<e?j(e):e,ar[e]||(typeof document<"u"?document.querySelector(e):void 0)}function dt(e,t,r){var a=Re(e);if(!a)return-4;if(a.ra&&(s()[a.ra>>2]=t,s()[a.ra+4>>2]=r),a.Ca||!a.bb)a.Ca&&(a=a.Ca),e=!1,a.qa&&a.qa.pa&&(e=a.qa.pa.getParameter(2978),e=e[0]===0&&e[1]===0&&e[2]===a.width&&e[3]===a.height),a.width=t,a.height=r,e&&a.qa.pa.viewport(0,0,t,r);else{if(a.ra){a=s()[a.ra+8>>2],e=e?j(e):"";var u=ye(),i=U(12),l=0;if(e){l=De(e)+1;var m=q(l);se(e,C(),m,l),l=m}return s()[i>>2]=l,s()[i+4>>2]=t,s()[i+8>>2]=r,jt(0,a,657457152,0,l,i),te(u),1}return-4}return 0}function mt(e,t,r){return c?T(5,1,e,t,r):dt(e,t,r)}function or(e){var t=e.getExtension("ANGLE_instanced_arrays");t&&(e.vertexAttribDivisor=function(r,a){t.vertexAttribDivisorANGLE(r,a)},e.drawArraysInstanced=function(r,a,u,i){t.drawArraysInstancedANGLE(r,a,u,i)},e.drawElementsInstanced=function(r,a,u,i,l){t.drawElementsInstancedANGLE(r,a,u,i,l)})}function ir(e){var t=e.getExtension("OES_vertex_array_object");t&&(e.createVertexArray=function(){return t.createVertexArrayOES()},e.deleteVertexArray=function(r){t.deleteVertexArrayOES(r)},e.bindVertexArray=function(r){t.bindVertexArrayOES(r)},e.isVertexArray=function(r){return t.isVertexArrayOES(r)})}function ur(e){var t=e.getExtension("WEBGL_draw_buffers");t&&(e.drawBuffers=function(r,a){t.drawBuffersWEBGL(r,a)})}function sr(e){if(e||(e=fr),!e.Ka){e.Ka=!0;var t=e.pa;or(t),ir(t),ur(t),t.cb=t.getExtension("EXT_disjoint_timer_query"),t.ib=t.getExtension("WEBGL_multi_draw"),(t.getSupportedExtensions()||[]).forEach(function(r){0>r.indexOf("lose_context")&&0>r.indexOf("debug")&&t.getExtension(r)})}}var fr,lr=["default","low-power","high-performance"],pt={};function ht(){if(!Pe){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:ae||"./this.program"},t;for(t in pt)e[t]=pt[t];var r=[];for(t in e)r.push(t+"="+e[t]);Pe=r}return Pe}var Pe;function gt(e,t){if(c)return T(6,1,e,t);var r=0;return ht().forEach(function(a,u){var i=t+r;for(u=s()[e+4*u>>2]=i,i=0;i<a.length;++i)L()[u++>>0]=a.charCodeAt(i);L()[u>>0]=0,r+=a.length+1}),0}function _t(e,t){if(c)return T(7,1,e,t);var r=ht();s()[e>>2]=r.length;var a=0;return r.forEach(function(u){a+=u.length+1}),s()[t>>2]=a,0}function vt(e){return c?T(8,1,e):0}function yt(e,t,r,a){return c?T(9,1,e,t,r,a):(e=it.fb(e),t=it.eb(e,t,r),s()[a>>2]=t,0)}function wt(e,t,r,a,u){if(c)return T(10,1,e,t,r,a,u)}function At(e,t,r,a){if(c)return T(11,1,e,t,r,a);for(var u=0,i=0;i<r;i++){for(var l=s()[t+8*i>>2],m=s()[t+(8*i+4)>>2],_=0;_<m;_++){var h=C()[l+_],w=nr[e];h===0||h===10?((e===1?He:b)(Ne(w,0)),w.length=0):w.push(h)}u+=m}return s()[a>>2]=u,0}function bt(e){if(c)throw"Internal Error! spawnThread() can only ever be called from main application thread!";var t=f.Ja();if(t.ea!==void 0)throw"Internal error!";if(!e.sa)throw"Internal error, no pthread ptr!";f.ia.push(t);for(var r=q(512),a=0;128>a;++a)s()[r+4*a>>2]=0;var u=e.ja+e.ka;a=f.ga[e.sa]={worker:t,ja:e.ja,ka:e.ka,xa:e.xa,ha:e.sa};var i=a.ha>>2;Atomics.store(g(),i+16,e.detached),Atomics.store(g(),i+25,r),Atomics.store(g(),i+10,a.ha),Atomics.store(g(),i+20,e.ka),Atomics.store(g(),i+19,u),Atomics.store(g(),i+26,e.ka),Atomics.store(g(),i+28,u),Atomics.store(g(),i+29,e.detached),r=kt()+40,Atomics.store(g(),i+43,r),t.ea=a;var l={cmd:"run",start_routine:e.Sa,arg:e.ma,threadInfoStruct:e.sa,stackBase:e.ja,stackSize:e.ka};t.na=function(){l.time=performance.now(),t.postMessage(l,e.Za)},t.loaded&&(t.na(),delete t.na)}function cr(e,t){if(!e)return b("pthread_join attempted on a null thread pointer!"),71;if(c&&P()==e)return b("PThread "+e+" is attempting to join to itself!"),16;if(!c&&Tt()==e)return b("Main thread "+e+" is attempting to join to itself!"),16;if(s()[e+12>>2]!==e)return b("pthread_join attempted on thread "+e+", which does not point to a valid thread, or does not exist anymore!"),71;if(Atomics.load(g(),e+64>>2))return b("Attempted to join thread "+e+", which was already detached!"),28;for(lt();;){var r=Atomics.load(g(),e+0>>2);if(r==1)return r=Atomics.load(g(),e+4>>2),t&&(s()[t>>2]=r),Atomics.store(g(),e+64>>2,1),c?postMessage({cmd:"cleanupThread",thread:e}):ot(e),0;if(c){var a=P();if(a&&!Atomics.load(g(),a+56>>2)&&Atomics.load(g(),a+0>>2)==2)throw"Canceled!"}c||_e(),ct(e+0,r,c?100:1)}}function de(e){return e%4===0&&(e%100!==0||e%400===0)}function Fe(e,t){for(var r=0,a=0;a<=t;r+=e[a++]);return r}var me=[31,29,31,30,31,30,31,31,30,31,30,31],pe=[31,28,31,30,31,30,31,31,30,31,30,31];function he(e,t){for(e=new Date(e.getTime());0<t;){var r=e.getMonth(),a=(de(e.getFullYear())?me:pe)[r];if(t>a-e.getDate())t-=a-e.getDate()+1,e.setDate(1),11>r?e.setMonth(r+1):(e.setMonth(0),e.setFullYear(e.getFullYear()+1));else{e.setDate(e.getDate()+t);break}}return e}function dr(e,t,r,a){function u(o,p,A){for(o=typeof o=="number"?o.toString():o||"";o.length<p;)o=A[0]+o;return o}function i(o,p){return u(o,p,"0")}function l(o,p){function A(Wt){return 0>Wt?-1:0<Wt?1:0}var H;return(H=A(o.getFullYear()-p.getFullYear()))===0&&(H=A(o.getMonth()-p.getMonth()))===0&&(H=A(o.getDate()-p.getDate())),H}function m(o){switch(o.getDay()){case 0:return new Date(o.getFullYear()-1,11,29);case 1:return o;case 2:return new Date(o.getFullYear(),0,3);case 3:return new Date(o.getFullYear(),0,2);case 4:return new Date(o.getFullYear(),0,1);case 5:return new Date(o.getFullYear()-1,11,31);case 6:return new Date(o.getFullYear()-1,11,30)}}function _(o){o=he(new Date(o.da+1900,0,1),o.wa);var p=new Date(o.getFullYear()+1,0,4),A=m(new Date(o.getFullYear(),0,4));return p=m(p),0>=l(A,o)?0>=l(p,o)?o.getFullYear()+1:o.getFullYear():o.getFullYear()-1}var h=s()[a+40>>2];a={Xa:s()[a>>2],Wa:s()[a+4>>2],ua:s()[a+8>>2],oa:s()[a+12>>2],la:s()[a+16>>2],da:s()[a+20>>2],va:s()[a+24>>2],wa:s()[a+28>>2],mb:s()[a+32>>2],Va:s()[a+36>>2],Ya:h?j(h):""},r=j(r),h={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var w in h)r=r.replace(new RegExp(w,"g"),h[w]);var re="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Ae="January February March April May June July August September October November December".split(" ");h={"%a":function(o){return re[o.va].substring(0,3)},"%A":function(o){return re[o.va]},"%b":function(o){return Ae[o.la].substring(0,3)},"%B":function(o){return Ae[o.la]},"%C":function(o){return i((o.da+1900)/100|0,2)},"%d":function(o){return i(o.oa,2)},"%e":function(o){return u(o.oa,2," ")},"%g":function(o){return _(o).toString().substring(2)},"%G":function(o){return _(o)},"%H":function(o){return i(o.ua,2)},"%I":function(o){return o=o.ua,o==0?o=12:12<o&&(o-=12),i(o,2)},"%j":function(o){return i(o.oa+Fe(de(o.da+1900)?me:pe,o.la-1),3)},"%m":function(o){return i(o.la+1,2)},"%M":function(o){return i(o.Wa,2)},"%n":function(){return`
`},"%p":function(o){return 0<=o.ua&&12>o.ua?"AM":"PM"},"%S":function(o){return i(o.Xa,2)},"%t":function(){return"	"},"%u":function(o){return o.va||7},"%U":function(o){var p=new Date(o.da+1900,0,1),A=p.getDay()===0?p:he(p,7-p.getDay());return o=new Date(o.da+1900,o.la,o.oa),0>l(A,o)?i(Math.ceil((31-A.getDate()+(Fe(de(o.getFullYear())?me:pe,o.getMonth()-1)-31)+o.getDate())/7),2):l(A,p)===0?"01":"00"},"%V":function(o){var p=new Date(o.da+1901,0,4),A=m(new Date(o.da+1900,0,4));p=m(p);var H=he(new Date(o.da+1900,0,1),o.wa);return 0>l(H,A)?"53":0>=l(p,H)?"01":i(Math.ceil((A.getFullYear()<o.da+1900?o.wa+32-A.getDate():o.wa+1-A.getDate())/7),2)},"%w":function(o){return o.va},"%W":function(o){var p=new Date(o.da,0,1),A=p.getDay()===1?p:he(p,p.getDay()===0?1:7-p.getDay()+1);return o=new Date(o.da+1900,o.la,o.oa),0>l(A,o)?i(Math.ceil((31-A.getDate()+(Fe(de(o.getFullYear())?me:pe,o.getMonth()-1)-31)+o.getDate())/7),2):l(A,p)===0?"01":"00"},"%y":function(o){return(o.da+1900).toString().substring(2)},"%Y":function(o){return o.da+1900},"%z":function(o){o=o.Va;var p=0<=o;return o=Math.abs(o)/60,(p?"+":"-")+("0000"+(o/60*100+o%60)).slice(-4)},"%Z":function(o){return o.Ya},"%%":function(){return"%"}};for(w in h)0<=r.indexOf(w)&&(r=r.replace(new RegExp(w,"g"),h[w](a)));return w=pr(r),w.length>t?0:(Ve(w,e),w.length-1)}c||f.La();var mr=[null,function(e,t){if(c)return T(1,1,e,t)},ut,st,ft,mt,gt,_t,vt,yt,wt,At];function pr(e){var t=Array(De(e)+1);return se(e,t,0,t.length),t}var hr={c:function(e,t,r,a){Y("Assertion failed: "+j(e)+", at: "+[t?j(t):"unknown filename",r,a?j(a):"unknown function"])},i:ut,q:st,r:ft,E:function(e,t){if(e==t)postMessage({cmd:"processQueuedMainThreadWork"});else if(c)postMessage({targetThread:e,cmd:"processThreadQueue"});else{if(e=(e=f.ga[e])&&e.worker,!e)return;e.postMessage({cmd:"processThreadQueue"})}return 1},b:function(){Y()},v:function(e,t){if(e===0)e=Date.now();else if(e===1||e===4)e=Ie();else return s()[xt()>>2]=28,-1;return s()[t>>2]=e/1e3|0,s()[t+4>>2]=e%1e3*1e6|0,0},n:function(e,t,r){je.length=0;var a;for(r>>=2;a=C()[t++];)(a=105>a)&&r&1&&r++,je.push(a?ke()[r++>>1]:s()[r]),++r;return at[e].apply(null,je)},z:lt,m:function(){},f:ct,e:ce,g:Ie,u:function(e,t,r){C().copyWithin(e,t,t+r)},A:function(e,t,r){Oe.length=t,r>>=3;for(var a=0;a<t;a++)Oe[a]=ke()[r+a];return(0>e?at[-e-1]:mr[e]).apply(null,Oe)},d:function(e){e>>>=0;var t=C().length;if(e<=t||2147483648<e)return!1;for(var r=1;4>=r;r*=2){var a=t*(1+.2/r);a=Math.min(a,e+100663296),a=Math.max(16777216,e,a),0<a%65536&&(a+=65536-a%65536);e:{try{y.grow(Math.min(2147483648,a)-M.byteLength+65535>>>16),W(y.buffer);var u=1;break e}catch{}u=void 0}if(u)return!0}return!1},C:function(e,t,r){return Re(e)?dt(e,t,r):mt(e,t,r)},l:function(){},D:function(e,t){t>>=2;var r=s()[t+6];if(t={alpha:!!s()[t],depth:!!s()[t+1],stencil:!!s()[t+2],antialias:!!s()[t+3],premultipliedAlpha:!!s()[t+4],preserveDrawingBuffer:!!s()[t+5],powerPreference:lr[r],failIfMajorPerformanceCaveat:!!s()[t+7],Oa:s()[t+8],hb:s()[t+9],Aa:s()[t+10],Ha:s()[t+11],jb:s()[t+12],kb:s()[t+13]},e=Re(e),!e||t.Ha)t=0;else if(e=e.getContext("webgl",t)){r=q(8),s()[r+4>>2]=P();var a={gb:r,attributes:t,version:t.Oa,pa:e};e.canvas&&(e.canvas.qa=a),(typeof t.Aa>"u"||t.Aa)&&sr(a),t=r}else t=0;return t},x:gt,y:_t,h:function(e){We(e)},j:vt,p:yt,s:wt,o:At,t:function(){f.Ma()},a:y||n.wasmMemory,k:function(e,t,r,a){if(typeof SharedArrayBuffer>"u")return b("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;if(!e)return b("pthread_create called with a null thread pointer!"),28;var u=[];if(c&&u.length===0)return It(687865856,e,t,r,a);var i=0,l=0;if(t&&t!=-1){var m=s()[t>>2];m+=81920,i=s()[t+8>>2],l=s()[t+12>>2]!==0}else m=2097152;(t=i==0)?i=Pt(16,m):(i-=m,K(0<i));for(var _=q(228),h=0;57>h;++h)g()[(_>>2)+h]=0;return s()[e>>2]=_,s()[_+12>>2]=_,e=_+152,s()[e>>2]=e,r={ja:i,ka:m,xa:t,detached:l,Sa:r,sa:_,ma:a,Za:u},c?(r.ab="spawnThread",postMessage(r,u)):bt(r),0},B:function(e,t){return cr(e,t)},w:function(e,t,r,a){return dr(e,t,r,a)}};(function(){function e(u,i){if(n.asm=u.exports,fe=n.asm.ca,Le=i,!c){var l=f.fa.length;f.fa.forEach(function(m){f.Ba(m,function(){if(!--l&&(B--,n.monitorRunDependencies&&n.monitorRunDependencies(B),B==0&&ee)){var _=ee;ee=null,_()}})})}}function t(u){e(u.instance,u.module)}function r(u){return rr().then(function(i){return WebAssembly.instantiate(i,a)}).then(u,function(i){b("failed to asynchronously prepare wasm: "+i),Y(i)})}var a={a:hr};if(c||(K(!c,"addRunDependency cannot be used in a pthread worker"),B++,n.monitorRunDependencies&&n.monitorRunDependencies(B)),n.instantiateWasm)try{return n.instantiateWasm(a,e)}catch(u){return b("Module.instantiateWasm callback failed with error: "+u),!1}return(function(){return Z||typeof WebAssembly.instantiateStreaming!="function"||rt()||typeof fetch!="function"?r(t):fetch(R,{credentials:"same-origin"}).then(function(u){return WebAssembly.instantiateStreaming(u,a).then(t,function(i){return b("wasm streaming compile failed: "+i),b("falling back to ArrayBuffer instantiation"),r(t)})})})().catch(Me),{}})();var Et=n.___wasm_call_ctors=function(){return(Et=n.___wasm_call_ctors=n.asm.F).apply(null,arguments)};n._main=function(){return(n._main=n.asm.G).apply(null,arguments)};var q=n._malloc=function(){return(q=n._malloc=n.asm.H).apply(null,arguments)},ge=n._free=function(){return(ge=n._free=n.asm.I).apply(null,arguments)};n._uci_command=function(){return(n._uci_command=n.asm.J).apply(null,arguments)};var kt=n._emscripten_get_global_libc=function(){return(kt=n._emscripten_get_global_libc=n.asm.K).apply(null,arguments)},xt=n.___errno_location=function(){return(xt=n.___errno_location=n.asm.L).apply(null,arguments)};n.___em_js__initPthreadsJS=function(){return(n.___em_js__initPthreadsJS=n.asm.M).apply(null,arguments)};var P=n._pthread_self=function(){return(P=n._pthread_self=n.asm.N).apply(null,arguments)},Mt=n.___pthread_tsd_run_dtors=function(){return(Mt=n.___pthread_tsd_run_dtors=n.asm.O).apply(null,arguments)};n._emscripten_current_thread_process_queued_calls=function(){return(n._emscripten_current_thread_process_queued_calls=n.asm.P).apply(null,arguments)};var St=n._emscripten_register_main_browser_thread_id=function(){return(St=n._emscripten_register_main_browser_thread_id=n.asm.Q).apply(null,arguments)},Tt=n._emscripten_main_browser_thread_id=function(){return(Tt=n._emscripten_main_browser_thread_id=n.asm.R).apply(null,arguments)},Dt=n.__emscripten_do_dispatch_to_thread=function(){return(Dt=n.__emscripten_do_dispatch_to_thread=n.asm.S).apply(null,arguments)},It=n._emscripten_sync_run_in_main_thread_4=function(){return(It=n._emscripten_sync_run_in_main_thread_4=n.asm.T).apply(null,arguments)},_e=n._emscripten_main_thread_process_queued_calls=function(){return(_e=n._emscripten_main_thread_process_queued_calls=n.asm.U).apply(null,arguments)},Ot=n._emscripten_run_in_main_runtime_thread_js=function(){return(Ot=n._emscripten_run_in_main_runtime_thread_js=n.asm.V).apply(null,arguments)},jt=n.__emscripten_call_on_thread=function(){return(jt=n.__emscripten_call_on_thread=n.asm.W).apply(null,arguments)};n._emscripten_tls_init=function(){return(n._emscripten_tls_init=n.asm.X).apply(null,arguments)};var ve=n.__emscripten_thread_init=function(){return(ve=n.__emscripten_thread_init=n.asm.Y).apply(null,arguments)},ye=n.stackSave=function(){return(ye=n.stackSave=n.asm.Z).apply(null,arguments)},te=n.stackRestore=function(){return(te=n.stackRestore=n.asm._).apply(null,arguments)},U=n.stackAlloc=function(){return(U=n.stackAlloc=n.asm.$).apply(null,arguments)},Rt=n._emscripten_stack_set_limits=function(){return(Rt=n._emscripten_stack_set_limits=n.asm.aa).apply(null,arguments)},Pt=n._memalign=function(){return(Pt=n._memalign=n.asm.ba).apply(null,arguments)},Ft=n.__emscripten_allow_main_runtime_queued_calls=25580,z=n.__emscripten_main_thread_futex=1088592;n.ccall=function(e,t,r,a){var u={string:function(h){var w=0;if(h!=null&&h!==0){var re=(h.length<<2)+1,Ae=w=U(re);se(h,C(),Ae,re)}return w},array:function(h){var w=U(h.length);return Ve(h,w),w}},i=Kt(e),l=[];if(e=0,a)for(var m=0;m<a.length;m++){var _=u[r[m]];_?(e===0&&(e=ye()),l[m]=_(a[m])):l[m]=a[m]}return r=i.apply(null,l),r=(function(h){return t==="string"?j(h):t==="boolean"?!!h:h})(r),e!==0&&te(e),r},n.PThread=f,n.PThread=f,n.wasmMemory=y,n.ExitStatus=X;var we;function X(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}ee=function e(){we||Ce(),we||(ee=e)};function Ce(e){function t(){if(!we&&(we=!0,n.calledRun=!0,!Te)){if(le(et),c||le(er),xe(n),n.onRuntimeInitialized&&n.onRuntimeInitialized(),Ct){var r=e,a=n._main;r=r||[];var u=r.length+1,i=U(4*(u+1));s()[i>>2]=Ge(ae);for(var l=1;l<u;l++)s()[(i>>2)+l]=Ge(r[l-1]);s()[(i>>2)+u]=0;try{var m=a(u,i);We(m,!0)}catch(_){_ instanceof X||(_=="unwind"?V=!0:((r=_)&&typeof _=="object"&&_.stack&&(r=[_,_.stack]),b("exception thrown: "+r),oe(1,_)))}}if(!c){if(n.postRun)for(typeof n.postRun=="function"&&(n.postRun=[n.postRun]);n.postRun.length;)r=n.postRun.shift(),tt.unshift(r);le(tt)}}}if(e=e||Se,!(0<B))if(c)xe(n),postMessage({cmd:"loaded"});else{if(!c){if(n.preRun)for(typeof n.preRun=="function"&&(n.preRun=[n.preRun]);n.preRun.length;)tr();le(Ke)}0<B||(n.setStatus?(n.setStatus("Running..."),setTimeout(function(){setTimeout(function(){n.setStatus("")},1),t()},1)):t())}}n.run=Ce;function We(e,t){if(!t||!V||e!==0){if(!t&&c)throw postMessage({cmd:"exitProcess",returnCode:e}),new X(e);V||(f.Ea(),n.onExit&&n.onExit(e),Te=!0),oe(e,new X(e))}}if(n.preInit)for(typeof n.preInit=="function"&&(n.preInit=[n.preInit]);0<n.preInit.length;)n.preInit.pop()();var Ct=!0;return n.noInitialRun&&(Ct=!1),V=!c,c&&f.Na(),Ce(),S.ready})})();d.exports=E})(be)),be.exports}var Lt=Ht(),Nt=Bt(Lt),Gt="/assets/stockfish-CQYUjctR.js",Vt="/assets/stockfish-DjC3feD2.wasm",zt="/assets/stockfish.worker-CgPcgrCX.js";const Xt={beginner:{skill:4,movetime:300,depth:8,delayMs:250},intermediate:{skill:10,movetime:600,depth:12,delayMs:200},expert:{skill:18,movetime:900,depth:16,delayMs:150}},Qt={skill:20,movetime:1500,depth:24,delayMs:150};function $t(d,k=!1,E="ai"){const v=E==="aivsai"&&d==="expert"?Qt:Xt[d];return k?{...v,movetime:v.movetime+250}:v}let Ee=null,ne=null;const Jt=d=>{if(typeof d=="string"&&d.startsWith("bestmove")){const E=d.split(" ")[1];if(ne){const v={id:ne,bestMove:E};self.postMessage(v)}ne=null}},Zt=async()=>(Ee||(Ee=Nt({locateFile:d=>d.endsWith(".wasm")?Vt:d.endsWith(".worker.js")?zt:d,mainScriptUrlOrBlob:Gt}).then(d=>(d.addMessageListener(Jt),d.postMessage("uci"),d))),Ee);self.onmessage=async d=>{const k=d.data;if(k.type!=="bestmove")return;const E=await Zt();ne=k.id;const v=$t(k.difficulty,k.retry,k.mode??"ai");E.postMessage("ucinewgame"),E.postMessage(`setoption name Skill Level value ${v.skill}`),E.postMessage(`position fen ${k.fen}`),E.postMessage(`go movetime ${v.movetime} depth ${v.depth}`)}})();
